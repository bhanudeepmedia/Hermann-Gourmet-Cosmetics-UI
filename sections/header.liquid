<header class="site-header" data-sticky="{{ section.settings.sticky }}">
    <div class="container header-broad">
      
      <!-- 1. Mobile Toggle -->
      <button class="menu-toggle mobile-only" aria-label="Menu" id="mobile-toggle">
         <span class="hamburger-line"></span>
         <span class="hamburger-line"></span>
      </button>

      <!-- 2. Desktop Navigation (Left) -->
      <nav class="desktop-nav left-nav desktop-only">
        <ul class="nav-links">
           {% for link in linklists[section.settings.main_menu].links limit:3 %}
             <li><a href="{{ link.url }}" class="nav-item">{{ link.title }}</a></li>
           {% endfor %}
        </ul>
      </nav>

      <!-- 3. Logo (Center) -->
      <div class="header-logo">
        <a href="{{ routes.root_url }}">
          {% if section.settings.logo %}
            <img src="{{ section.settings.logo | img_url: '400x' }}" alt="{{ shop.name }}" style="max-width: {{ section.settings.logo_width }}px;">
          {% else %}
             <span class="logo-text">{{ section.settings.logo_text }}</span>
          {% endif %}
        </a>
      </div>

       <!-- 4. Desktop Navigation (Right) -->
      <nav class="desktop-nav right-nav desktop-only">
        <ul class="nav-links">
           {% for link in linklists[section.settings.main_menu].links offset:3 %}
             <li><a href="{{ link.url }}" class="nav-item">{{ link.title }}</a></li>
           {% endfor %}
        </ul>
      </nav>

      <!-- 5. Actions (Search/Cart) -->
      <div class="header-actions">
         <button class="action-btn search-trigger" aria-label="Search">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
         </button>
         <a href="{{ routes.cart_url }}" class="action-btn cart-btn">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
            <span class="cart-count">{{ cart.item_count }}</span>
         </a>
      </div>

    </div>
    
    <!-- Expanded Search Bar -->
    <div class="search-overlay">
       <div class="container container-narrow">
          <form action="{{ routes.search_url }}" method="get" class="big-search-form">
             <input type="text" name="q" placeholder="Type to search..." class="big-search-input">
             <button type="submit" class="big-search-btn">Search</button>
          </form>
          <button class="close-search">✕</button>
       </div>
    </div>

    <!-- Mobile Drawer -->
    <div class="mobile-drawer" id="mobile-drawer">
       <div class="drawer-header">
          <span class="drawer-logo">{{ section.settings.logo_text }}</span>
          <button class="close-drawer">✕</button>
       </div>
       <ul class="mobile-menu-list">
          {% for link in linklists[section.settings.main_menu].links %}
            <li>
               <a href="{{ link.url }}">{{ link.title }}</a>
               {% if link.links != blank %}
                 <ul class="mobile-sub">
                   {% for child in link.links %}
                     <li><a href="{{ child.url }}">{{ child.title }}</a></li>
                   {% endfor %}
                 </ul>
               {% endif %}
            </li>
          {% endfor %}
       </ul>
    </div>
</header>
  
<style>
/* PREMIUM HEADER V3 STYLES */
.site-header {
  padding: 1.5rem 0;
  background: var(--c-bg);
  transition: padding 0.3s ease;
  z-index: 1000; position: relative;
}
.site-header[data-sticky="true"] { position: sticky; top: 0; }

.header-broad {
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: relative;
}

/* Nav Links */
.desktop-nav .nav-links {
  display: flex; gap: 2.5rem; list-style: none; margin: 0; padding: 0;
}
.nav-item {
  font-family: var(--font-body);
  font-size: 0.9rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--c-text);
  text-decoration: none;
  position: relative;
}
.nav-item::after {
  content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 1px; background: var(--c-accent); transition: width 0.3s;
}
.nav-item:hover::after { width: 100%; }

/* Logo */
.header-logo { text-align: center; flex: 1; }
.logo-text { font-family: var(--font-heading); font-size: 2rem; color: var(--c-text); font-weight: 400; }

/* Actions */
.header-actions { display: flex; gap: 1.5rem; align-items: center; }
.action-btn { background: none; border: none; cursor: pointer; color: var(--c-text); padding: 5px; position: relative; }
.cart-count { 
  position: absolute; top: -5px; right: -8px; 
  background: var(--c-accent); color: white; 
  font-size: 0.7rem; width: 18px; height: 18px; border-radius: 50%;
  display: flex; justify-content: center; align-items: center;
}

/* Search Overlay */
.search-overlay {
  position: absolute; top: 100%; left: 0; width: 100%;
  background: white; padding: 3rem 0;
  box-shadow: 0 10px 30px rgba(0,0,0,0.05);
  opacity: 0; visibility: hidden; transform: translateY(-10px);
  transition: all 0.3s ease;
}
.search-overlay.active { opacity: 1; visibility: visible; transform: translateY(0); }
.big-search-form { display: flex; border-bottom: 2px solid #eee; padding-bottom: 1rem; }
.big-search-input { width: 100%; border: none; font-size: 2rem; outline: none; font-family: var(--font-heading); background: transparent; }
.big-search-btn { background: none; border: none; font-weight: 600; text-transform: uppercase; cursor: pointer; }

/* Mobile Drawer */
.mobile-drawer {
  position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
  background: var(--c-bg); z-index: 2000;
  transform: translateX(-100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  padding: 2rem; display: flex; flex-direction: column;
}
.mobile-drawer.active { transform: translateX(0); }
.drawer-header { display: flex; justify-content: space-between; margin-bottom: 3rem; font-family: var(--font-heading); font-size: 1.5rem; }
.mobile-menu-list { list-style: none; padding: 0; }
.mobile-menu-list li a { font-size: 1.8rem; display: block; padding: 1rem 0; border-bottom: 1px solid rgba(0,0,0,0.05); color: var(--c-text); font-family: var(--font-heading); }
.close-drawer { background: none; border: none; font-size: 1.5rem; cursor: pointer; }

/* Responsive */
.mobile-only { display: none; }
@media (max-width: 1000px) {
  .desktop-only { display: none; }
  .mobile-only { display: block; }
  .header-logo { text-align: left; }
  .header-broad { justify-content: space-between; }
  .hamburger-line { display: block; width: 24px; height: 2px; background: var(--c-text); margin: 6px 0; }
}
</style>

<script>
  // Search Toggle
  const searchBtn = document.querySelector('.search-trigger');
  const searchOverlay = document.querySelector('.search-overlay');
  const closeSearch = document.querySelector('.close-search');
  
  if(searchBtn) {
     searchBtn.addEventListener('click', () => searchOverlay.classList.toggle('active'));
     closeSearch.addEventListener('click', () => searchOverlay.classList.remove('active'));
  }

  // Mobile Menu
  const mobileToggle = document.getElementById('mobile-toggle');
  const mobileDrawer = document.getElementById('mobile-drawer');
  const closeDrawer = document.querySelector('.close-drawer');

  if(mobileToggle) {
    mobileToggle.addEventListener('click', () => mobileDrawer.classList.toggle('active'));
    closeDrawer.addEventListener('click', () => mobileDrawer.classList.remove('active'));
  }
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    { "type": "image_picker", "id": "logo", "label": "Logo" },
    { "type": "text", "id": "logo_text", "label": "Logo Text", "default": "HERMANN" },
    { "type": "range", "id": "logo_width", "min": 50, "max": 300, "label": "Logo Width", "default": 140 },
    { "type": "link_list", "id": "main_menu", "label": "Menu", "default": "main-menu" },
    { "type": "checkbox", "id": "sticky", "label": "Sticky Header", "default": true }
  ]
}
{% endschema %}
