<section class="section shop-section" id="shop">
  <div class="container">
    <div class="section-header">
      <h2>{{ section.settings.heading }}</h2>
      {% if section.settings.view_all_link %}
        <a href="{{ section.settings.view_all_link }}" class="link-arrow">View All Products →</a>
      {% endif %}
    </div>
    
    <div class="product-grid">
      {% if section.settings.collection %}
        {% assign collection = collections[section.settings.collection] %}
        {% for product in collection.products limit: section.settings.products_to_show %}
          <div class="product-card-fun">
            <div class="p-image">
              {% if product.tags contains 'bestseller' %}
                <span class="tag-bestseller">Best Seller</span>
              {% elsif product.tags contains 'new' %}
                <span class="tag-new">New Batch</span>
              {% endif %}
              
              <a href="{{ product.url }}">
                {% if product.featured_image %}
                  <img src="{{ product.featured_image | img_url: '600x' }}" alt="{{ product.title }}">
                {% else %}
                  {{ 'product-1' | placeholder_svg_tag }}
                {% endif %}
              </a>
              
              <button class="quick-add" data-product-id="{{ product.id }}">
                <i class="fa-solid fa-plus"></i>
              </button>
            </div>
            <div class="p-info">
              {% if product.metafields.custom.rating %}
                <div class="stars">{{ product.metafields.custom.rating }}</div>
              {% endif %}
              <h3><a href="{{ product.url }}">{{ product.title }}</a></h3>
              <p>{{ product.metafields.custom.subtitle | default: product.description | strip_html | truncate: 40 }}</p>
              <div class="price">{{ product.price | money }}</div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        {% comment %} Placeholder products {% endcomment %}
        {% for i in (1..4) %}
          <div class="product-card-fun">
            <div class="p-image">
              {{ 'product-' | append: i | placeholder_svg_tag }}
            </div>
            <div class="p-info">
              <h3>Sample Product {{ i }}</h3>
              <p>Product description</p>
              <div class="price">€45.00</div>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Product Grid",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Fresh From The Kitchen"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Products to Show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 4
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View All Link"
    }
  ],
  "presets": [
    {
      "name": "Product Grid"
    }
  ]
}
{% endschema %}
